

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>電路維修 - 佈局優化版</title>
    <style>
        body { background: #050505; color: #eee; text-align: center; font-family: sans-serif; }
        canvas { background: #000; border: 2px solid #333; margin-top: 10px; }
    </style>
</head>
<body>
    <h3 style="color:#00ffcc">佈局修正：解決電源遮擋 Power 入口問題</h3>
    <canvas id="gameCanvas" width="800" height="850"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        const CX = 400; 
        const CY = 450; 

        // 4 層方框設定
        const BOXES = [
            { size: 600 }, // 第 1 層 (外)
            { size: 460 }, // 第 2 層
            { size: 320 }, // 第 3 層
            { size: 180 }  // 第 4 層 (內)
        ];

        function drawMap() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 1. 電池 (POWER) 置於頂部，並拉開距離
            ctx.fillStyle = "#1a1a1a";
            ctx.fillRect(CX - 50, 10, 100, 50);
            ctx.strokeStyle = "#00ffcc";
            ctx.lineWidth = 2;
            ctx.strokeRect(CX - 50, 10, 100, 50);
            ctx.fillStyle = "#00ffcc";
            ctx.font = "14px Arial";
            ctx.fillText("POWER", CX - 26, 42);
            
            // 2. 灰色虛線電線 
            ctx.strokeStyle = "#333";
            ctx.setLineDash([5, 8]);
            ctx.lineWidth = 2;
            ctx.beginPath();

            // 電池引線 (拉長距離，避免遮擋)
            ctx.moveTo(CX, 60); ctx.lineTo(CX, CY - 300); 

            // 畫 4 個嵌套方框
            BOXES.forEach(box => {
                const half = box.size / 2;
                ctx.strokeRect(CX - half, CY - half, box.size, box.size);
            });

            // 畫十字軸線
            const maxSize = BOXES[0].size / 2;
            ctx.moveTo(CX, CY - maxSize); ctx.lineTo(CX, CY + maxSize); // 垂直
            ctx.moveTo(CX - maxSize, CY); ctx.lineTo(CX + maxSize, CY); // 水平
            ctx.stroke();

            // 3. 16 個紅框 (每圈 4 個，位於邊緣中點)
            ctx.setLineDash([]);
            BOXES.forEach(box => {
                const half = box.size / 2;
                const pos = [
                    {x: CX, y: CY - half}, {x: CX, y: CY + half}, // 上下
                    {x: CX - half, y: CY}, {x: CX + half, y: CY}  // 左右
                ];
                pos.forEach(p => {
                    ctx.strokeStyle = "red";
                    ctx.lineWidth = 2;
                    ctx.strokeRect(p.x - 25, p.y - 25, 50, 50);
                });
            });

            // 4. 放置 6 個電源點 (精確避開 POWER 字樣與紅框)
            // 將電源放在角落（對角線分佈），確保不會擋到垂直軸頂端的入口
            const targets = [
                {x: CX, y: CY}, // 1. 中心點
                {x: CX - 300, y: CY - 300}, // 2. 最外圈左上
                {x: CX + 300, y: CY + 300}, // 3. 最外圈右下
                {x: CX + 230, y: CY - 230}, // 4. 第二圈右上
                {x: CX - 160, y: CY + 160}, // 5. 第三圈左下
                {x: CX + 90, y: CY - 90}    // 6. 第四圈右上
            ];

            targets.forEach(t => {
                ctx.strokeStyle = "#00ffcc";
                ctx.fillStyle = "#002211";
                ctx.beginPath(); ctx.arc(t.x, t.y, 20, 0, Math.PI*2); ctx.fill(); ctx.stroke();
                ctx.fillStyle = "#00ffcc";
                ctx.beginPath(); ctx.arc(t.x, t.y, 5, 0, Math.PI*2); ctx.fill();
            });
        }

        drawMap();
    </script>
</body>
</html>
