<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>電路維修系統 - 佈線與方格</title>
    <style>
        body { background: #080808; color: #00ffcc; text-align: center; font-family: sans-serif; }
        canvas { background: #000; cursor: pointer; border: 2px solid #333; margin-top: 20px; }
    </style>
</head>
<body>

    <h2 style="color:#00ffcc">電路佈線測試 (Step 2: 16 個方格)</h2>
    <canvas id="gameCanvas" width="800" height="800"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const center = 400;

        // 定義 16 個方格的位置 (根據 未命名-1.jpg 分佈)
        const nodes = [
            // 垂直軸 (6個)
            { x: center, y: 150, type: 'T' }, 
            { x: center, y: 230, type: 'T' },
            { x: center, y: 310, type: 'T' },
            { x: center, y: 490, type: 'D' }, // 黃色特殊位置預留
            { x: center, y: 570, type: 'T' },
            { x: center, y: 650, type: 'T' },
            // 水平軸 (8個，中心綠燈兩側)
            { x: 160, y: center, type: 'T' }, { x: 240, y: center, type: 'D' },
            { x: 320, y: center, type: 'T' }, { x: 360, y: center, type: 'T' },
            { x: 440, y: center, type: 'L' }, { x: 480, y: center, type: 'D' },
            { x: 560, y: center, type: 'T' }, { x: 640, y: center, type: 'T' },
            // 外部連接點
            { x: 560, y: 480, type: 'L' }, { x: 640, y: 480, type: 'T' }
        ];

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 1. 畫電池 (左上角)
            ctx.fillStyle = "#1a1a1a";
            ctx.fillRect(40, 20, 160, 60);
            ctx.strokeStyle = "#00ffcc";
            ctx.strokeRect(40, 20, 160, 60);

            // 2. 畫原始虛線路徑 (未通電)
            ctx.strokeStyle = "#333";
            ctx.setLineDash([5, 8]);
            ctx.lineWidth = 2;

            // 電池引線
            ctx.beginPath();
            ctx.moveTo(200, 50); ctx.lineTo(center, 50); ctx.lineTo(center, 150);
            ctx.stroke();

            // 嵌套方框
            const rects = [80, 160, 240];
            rects.forEach(r => {
                ctx.strokeRect(center - r, center - r, r * 2, r * 2);
            });

            // 十字軸線
            ctx.beginPath();
            ctx.moveTo(center, 50); ctx.lineTo(center, 700); // 垂直
            ctx.moveTo(100, center); ctx.lineTo(700, center); // 水平
            ctx.stroke();

            // 3. 畫 16 個紅色方格
            ctx.setLineDash([]);
            nodes.forEach(n => {
                ctx.strokeStyle = "red";
                ctx.lineWidth = 1.5;
                ctx.strokeRect(n.x - 20, n.y - 20, 40, 40);

                // 畫內部符號 (測試用，先畫簡易線條)
                ctx.strokeStyle = n.type === 'D' ? "#ffff00" : "#0099ff";
                ctx.lineWidth = 3;
                ctx.beginPath();
                if (n.type === 'T') {
                    ctx.moveTo(n.x - 15, n.y); ctx.lineTo(n.x + 15, n.y);
                    ctx.moveTo(n.x, n.y); ctx.lineTo(n.x, n.y + 15);
                } else if (n.type === 'D') {
                    // 黃色特殊件 (雙弧)
                    ctx.arc(n.x - 15, n.y - 15, 15, 0, Math.PI/2);
                    ctx.moveTo(n.x + 15, n.y + 15);
                    ctx.arc(n.x + 15, n.y + 15, 15, Math.PI, Math.PI * 1.5);
                }
                ctx.stroke();
            });

            // 4. 畫中心與外圍電源 (綠圈)
            ctx.strokeStyle = "#00ffcc";
            const targets = [{x:center, y:center}, {x:680, y:120}, {x:600, y:200}, {x:120, y:680}];
            targets.forEach(t => {
                ctx.beginPath(); ctx.arc(t.x, t.y, 20, 0, Math.PI*2); ctx.stroke();
            });
        }

        draw();
    </script>
</body>
</html>
